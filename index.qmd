---
title: "Project title"
subtitle: "STA/ISS 313 - Project 1"
author: "Visualization Warriors"
format: html
editor: visual
---

## Abstract

(1 paragraph): Project abstract.

------------------------------------------------------------------------

## Introduction

The `pell` data set was featured on TidyTuesday in 2022. It contains information on the distribution of pell grant awards to college students in the United States from 1999-2017. This data set is a compilation of yearly datasets collected by the US Department of Education. The original yearly data was reported by the USDE in different ways across the years, after which it was cleaned up to become the \`pell\` data set that will be used in this project. 

The `pell` data set contains 100470 cases of Pell grant awards and contains 4 missing values. It explores the award amount in each school for each respective year represented in the data set. The variables in this data set include the state in which the school's located, the total Pell grant award the school gave, the number of students at the school who received a Pell grant, the name of the school, the session year, and the year. Specifically, the variables `NAME`, `FACTOR`, and `SESSION` are all factor variables while the other variables are numeric. There are some important notes to keep in mind when interpreting the data set. Firstly, the variable `STATE` includes both US states and territories, meaning there are more than 50 possible observation types. Finally, the difference between `SESSION` and `YEAR` is that `SESSION` indicates the academic school year (which is between two numeric years)

\

## Question 1: Need title.

### Introduction

(1-2 paragraphs): Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why you're interested in this question.

### Approach

(1-2 paragraphs): Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

### Analysis

(2-3 code blocks, 2 figures, text/code comments as needed): In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides. You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so. All plots must be made with **ggplot2**. Do not use base R or lattice plotting functions

```{r load-packages}
library(ggplot2)
library(tidyverse)
require(maps)
require(viridis)
install.packages("ISLR")
library(ISLR)
theme_set(
  theme_void()
)
```

```{r data-adjustment}
#load the region data set + join to original (be sure to account for the territories)

pell <- read_csv("data/pell.csv")
regions <- read_csv("data/region.csv")
enrollment <- read_csv("data/College_Enrollment_Data.csv")

pell <- pell |>
  drop_na(AWARD)

pell <- pell |>
  mutate(TERM = case_when(
    YEAR %in% c(1999, 2000) ~ 'Clinton (1999-2000)',
     YEAR %in% c(2001, 2002, 2003, 2004) ~ 'Bush (2001-2004)',
     YEAR %in% c(2005, 2006, 2007, 2008) ~ 'Bush (2005-2008)',
     YEAR %in% c(2009, 2010, 2011, 2012) ~ 'Obama (2009-2012)',
     YEAR %in% c(2013, 2014, 2015, 2016) ~ 'Obama (2013-2016)',
     YEAR %in% c(2017) ~ 'Trump (2017-2018)'
  ), 
  TERM = fct_relevel(TERM,
                     "Clinton (1999-2000)", "Bush (2001-2004)",
                     "Bush (2005-2008)", "Obama (2009-2012)",
                     "Obama (2013-2016)", "Trump (2017-2018)"
                     )
  )

pell_grouped <- pell |>
  group_by(STATE, TERM) %>%
  summarise(
    total_award = sum(AWARD),
    total_recipients = sum(RECIPIENT)
    ) %>%
  mutate(AVG_PELL_AWARD = total_award/total_recipients)

map_state <- map_data("state")
map_state$region <- str_to_title(map_state$region)
map_state$STATE <- state.abb[match(map_state$region, state.name)]
pell_map <- left_join(map_state, pell_grouped, by = "STATE")


```

```{r create q1-plot}
ggplot(pell_map, aes(long, lat, group = group)) + 
  geom_polygon(aes(fill = AVG_PELL_AWARD), color = "white") + 
  scale_fill_viridis_c(option = "B") + 
  facet_wrap(~TERM)

```

```{r}
pell2 <- inner_join(pell, regions) #decided to drop all territories

#began creating the avg_pell_award data
pell2 %>% 
  drop_na() %>% 
  group_by(YEAR) %>% 
  mutate(AVG_PELL_AWARD = mean(AWARD))
```

``` {visualization-1-time}
```

### Discussion

(1-3 paragraphs): In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots. Speculate about why the data looks the way it does.

## Question 2: Title that relates to the question you're answering

For our first visualization, we plan to use a line graph to visualize the proportion of students receiving a pell grant over time in each state. We will do this by having a line for each of the 50 states and having a very low alpha value for most of them, with a few that we want to highlight having a higher alpha level. This will allow us to clearly show a few notable stats over the top of the general trend for all of the states. For our second visualization, we plan to get the coordinates for each college by using a google maps API and then plotting a dot at each college. The dot will be sized based on the amount of pell grant recipients at the school and colored by the proportion of students receiving a pell grant. We then will put a few of these maps side by side each representing a different time period, possibly corresponding to presidential cycle. This will allow us to see trends in states and areas in both amounts of students and proportions.

```{r}
enrollment <- enrollment[1:51,] |>
  mutate(state = c("AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "DC", "FL", "GA",
           "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA",
           "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY",
           "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX",
           "UT", "VT", "VA", "WA", "WV", "WI", "WY")) |>
  select(c("Enrollment_2020", "state", "percent_change_from_2010"))

enrollment <- enrollment[, c(2,1,3)]

enrollment <- enrollment |>
  mutate(percent_change_from_2010 = as.numeric(gsub("\\%", "", percent_change_from_2010,)))



  


  mutate(Enrollment_2010 = (Enrollment_2020 / (1-(percent_change_from_2010/100)))



```


### Introduction

(1-2 paragraphs): Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why you're interested in this question.

### Approach

(1-2 paragraphs): Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

### Analysis

(2-3 code blocks, 2 figures, text/code comments as needed): In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides. You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so. All plots must be made with **ggplot2**. Do not use base R or lattice plotting functions.

### Discussion

(1-3 paragraphs): In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots. Speculate about why the data looks the way it does.
